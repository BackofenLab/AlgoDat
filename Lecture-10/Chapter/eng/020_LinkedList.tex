\section{Linked Lists}

\begin{frame}{Linked Lists}{Introduction}
  \textbf{Linked list:}
  \begin{itemize}
    \item
      Dynamic datastructure
    \item
      Number of elements changeable
    \item
      Data elements can be simple types upto complex datastructures
    \item
      Elements are linked through references / pointer to the predecessor /
      successor
    \item
      Singly / Doubly linked lists possible
  \end{itemize}
  \begin{figure}
    \input{Lecture/Images/LinkedList/SinglyLinkedListIntroduction.tikz}
    \caption{Singly linked list}
    \label{fig:linked_list:singly_linked_list}
  \end{figure}
\end{frame}

%-------------------------------------------------------------------------------

\begin{frame}{Linked Lists}{Introduction}
  \textbf{Compared to an array:}
  \begin{itemize}
    \item
      Extra space for storing pointer
    \item
      We do not need to copy elements on {\color{Mittel-Blau}\texttt{insert}}
      or {\color{Mittel-Blau}\texttt{remove}}
    \item
      The number of elements can be modified without big computational overhead
    \item
      No direct access of elements\\
      $\Rightarrow$ We have to iterate over the list
  \end{itemize}
\end{frame}

%-------------------------------------------------------------------------------

\begin{frame}{Linked Lists}{Variation}
  \textbf{List with head / last element pointer:}
  \begin{itemize}
    \item
      Head element has pointer to first list element
    \item
      Pointer to last element
    \item
      May also hold additional information:
      \begin{itemize}
        \item
          Number of elements
      \end{itemize}
  \end{itemize}
  \begin{figure}
    \input{Lecture/Images/LinkedList/SinglyLinkedListWithHead.tikz}
    \caption{Singly linked list}
    \label{fig:linked_list:variation:singly_linked_list_with_head}
  \end{figure}
\end{frame}

%-------------------------------------------------------------------------------

\begin{frame}{Linked Lists}{Variation}
  \textbf{Doubly linked list:}
  \begin{itemize}
    \item
      Pointer to successor element
    \item
      Pointer to predecessor element
    \item
      Iterate forward and backward
  \end{itemize}
  \begin{figure}
    \input{Lecture/Images/LinkedList/DoublyLinkedList.tikz}
    \caption{Doubly linked list}
    \label{fig:linked_list:variation:doubly_linked_list}
  \end{figure}
\end{frame}

%-------------------------------------------------------------------------------

\begin{frame}[fragile]{Linked Lists}{Implementation - Node - Python}
  \lstinputlisting[
    language=Python,
    tabsize=4,
    style={python-idle-code},
    escapechar={@},
    morekeywords={None},
    emph={Node, __init__},
    emphstyle=\color{blue}
  ]{Lecture/Code/LinkedList/Node.py}
\end{frame}

%-------------------------------------------------------------------------------

\begin{frame}[fragile]{Linked Lists}{Implementation - Node - Java}
  \lstinputlisting[
    language=Java,
    tabsize=4,
    style={java-eclipse-code},
    breaklines=false,
    mathescape=true,
%    escapechar={@},
    emph={value, next},
    emphstyle=\color{java_static}
  ]{Lecture/Code/LinkedList/NodePart1.java}
\end{frame}

%-------------------------------------------------------------------------------

\begin{frame}[fragile]{Linked Lists}{Implementation - Node - Java}
  \vspace{-1.125em}
  \lstinputlisting[
    language=Java,
    tabsize=4,
    style={java-eclipse-code},
    breaklines=false,
    mathescape=true,
    escapechar={@},
    emph={value, next},
    emphstyle=\color{java_static}
  ]{Lecture/Code/LinkedList/NodePart2.java}
\end{frame}

%-------------------------------------------------------------------------------

\begin{frame}[fragile]{Linked Lists}{Implementation - Node - Java}
  \lstinputlisting[
    language=Java,
    tabsize=4,
    style={java-eclipse-code},
    breaklines=false,
    mathescape=true,
    escapechar={@},
    emph={value, next},
    emphstyle=\color{java_static}
  ]{Lecture/Code/LinkedList/NodePart3.java}
\end{frame}

%-------------------------------------------------------------------------------

\begin{frame}[fragile]{Linked Lists}{Implementation - Node - C++ - Header}
  \vspace{-1.125em}
  \lstinputlisting[
    language=C++,
    tabsize=4,
    style={cpp-eclipse-code},
    breaklines=false,
    escapechar={@}
  ]{Lecture/Code/LinkedList/Node.h}
\end{frame}

%-------------------------------------------------------------------------------

\begin{frame}[fragile]{Linked Lists}{Implementation - Node - C++}
  \lstinputlisting[
    language=C++,
    tabsize=4,
    style={cpp-eclipse-code},
    breaklines=false,
    escapechar={@}
  ]{Lecture/Code/LinkedList/NodePart1.cpp}
\end{frame}

%-------------------------------------------------------------------------------

\begin{frame}[fragile]{Linked Lists}{Implementation - Node - C++}
  \lstinputlisting[
    language=C++,
    tabsize=4,
    style={cpp-eclipse-code},
    breaklines=false,
    escapechar={@}
  ]{Lecture/Code/LinkedList/NodePart2.cpp}
\end{frame}

%-------------------------------------------------------------------------------

\begin{frame}{Linked Lists}{Usage}
  \textbf{Creating linked lists:}
  \begin{itemize}
    \item
      \lstinline[
        language=Python,
        style={python-idle-code}
      ]|first = Node(7)|
      \begin{flushleft}
        \input{Lecture/Images/LinkedList/SinglyLinkedListCreate_First.tikz}
      \end{flushleft}
      \vspace{0.5em}
    \item
      \lstinline[
        language=Python,
        style={python-idle-code}
      ]|first.nextNode = Node(3)|
      \begin{flushleft}
        \input{Lecture/Images/LinkedList/SinglyLinkedListCreate_Second.tikz}
      \end{flushleft}
      \vspace{0.5em}
    \item
      \lstinline[
        language=Python,
        style={python-idle-code}
      ]|first.nextNode.value = 4|
      \begin{flushleft}
        \input{Lecture/Images/LinkedList/SinglyLinkedListCreate_Third.tikz}
      \end{flushleft}
  \end{itemize}
\end{frame}

%-------------------------------------------------------------------------------

\begin{frame}{Linked Lists}{Implementation - Insert}
  \textbf{Inserting a node after node \texttt{cur}:}
  \begin{flushleft}
    \input{Lecture/Images/LinkedList/SinglyLinkedListInsert_First.tikz}
  \end{flushleft}
\end{frame}

%-------------------------------------------------------------------------------

\begin{frame}{Linked Lists}{Implementation - Insert}
  \textbf{Inserting a node after node \texttt{cur}:}
  \begin{itemize}
    \item
      \lstinline[
      language=Python,
      style={python-idle-code}
      ]|ins = Node(n)|
  \end{itemize}
  \begin{flushleft}
    \input{Lecture/Images/LinkedList/SinglyLinkedListInsert_Second.tikz}
  \end{flushleft}
\end{frame}

%-------------------------------------------------------------------------------

\begin{frame}{Linked Lists}{Implementation - Insert}
  \textbf{Inserting a node after node \texttt{cur}:}
  \begin{itemize}
    \item
      \lstinline[
        language=Python,
        style={python-idle-code}
      ]|ins.nextNode = cur.nextNode|
  \end{itemize}
  \begin{flushleft}
    \input{Lecture/Images/LinkedList/SinglyLinkedListInsert_Third.tikz}
  \end{flushleft}
\end{frame}

%-------------------------------------------------------------------------------

\begin{frame}{Linked Lists}{Implementation - Insert}
  \textbf{Inserting a node after node \texttt{cur}:}
  \begin{itemize}
    \item
      \lstinline[
        language=Python,
        style={python-idle-code}
      ]|cur.nextNode = ins|
  \end{itemize}
  \begin{flushleft}
    \input{Lecture/Images/LinkedList/SinglyLinkedListInsert_Fourth.tikz}
  \end{flushleft}
\end{frame}

%-------------------------------------------------------------------------------

\begin{frame}{Linked Lists}{Implementation - Remove}
  \textbf{Removing a node \texttt{cur}:}
  \begin{flushleft}
    \input{Lecture/Images/LinkedList/SinglyLinkedListRemove_First.tikz}
  \end{flushleft}
\end{frame}

%-------------------------------------------------------------------------------

\begin{frame}{Linked Lists}{Implementation - Remove}
  \textbf{Removing a node \texttt{cur}:}
  \begin{itemize}
    \item
      Find the predecessor of \texttt{cur}:\\
      \lstinputlisting[
        language=Python,
        tabsize=4,
        style={python-idle-code},
        escapechar={@},
        emphstyle=\color{blue}
      ]{Lecture/Code/LinkedList/RemoveStep1.py}
    \item
      Runtime of $\mathcal{O}(n)$
    \item
      Does not work for first node!
  \end{itemize}
  \vspace{-1.5em}
  \begin{flushleft}
    \input{Lecture/Images/LinkedList/SinglyLinkedListRemove_Second.tikz}
  \end{flushleft}
\end{frame}

%-------------------------------------------------------------------------------

\begin{frame}{Linked Lists}{Implementation - Remove}
  \textbf{Removing a node \texttt{cur}:}
  \begin{itemize}
    \item
      Update the pointer to the next element:\\
      \lstinline[
        language=Python,
        style={python-idle-code}
      ]|pre.nextNode = cur.nextNode|
    \item
      \texttt{cur} will get automaticly destroyed if no more references exist
      (\lstinline[
        language=Python,
        style={python-idle-code},
        morekeywords={None}
      ]|cur=None|)
  \end{itemize}
  \begin{flushleft}
    \input{Lecture/Images/LinkedList/SinglyLinkedListRemove_Third.tikz}
  \end{flushleft}
\end{frame}

%-------------------------------------------------------------------------------

\begin{frame}{Linked Lists}{Implementation - Remove}
  \textbf{Removing the first node:}
  \begin{flushleft}
    \input{Lecture/Images/LinkedList/SinglyLinkedListRemoveFirst_First.tikz}
  \end{flushleft}
\end{frame}

%-------------------------------------------------------------------------------

\begin{frame}{Linked Lists}{Implementation - Remove}
  \textbf{Removing the first node:}
  \begin{itemize}
    \item
      Update the pointer to the next element:\\
      \lstinline[
        language=Python,
        style={python-idle-code}
      ]|first = first.nextNode|
    \item
      \texttt{cur} will get automaticly destroyed if no more references exist
      (\lstinline[
        language=Python,
        style={python-idle-code},
        morekeywords={None}
      ]|cur=None|)
  \end{itemize}
  \begin{flushright}
    \input{Lecture/Images/LinkedList/SinglyLinkedListRemoveFirst_Second.tikz}
  \end{flushright}
\end{frame}

%-------------------------------------------------------------------------------

\begin{frame}[fragile]{Linked Lists}{Implementation - Remove}
  \textbf{Removing a node \texttt{cur}:} (General case)
  \lstinputlisting[
    language=Python,
    tabsize=4,
    style={python-idle-code},
    escapechar={@},
    emphstyle=\color{blue}
  ]{Lecture/Code/LinkedList/Remove.py}
\end{frame}

%-------------------------------------------------------------------------------

\begin{frame}{Linked Lists}{Implementation - Head Node}
  \textbf{Using a \texttt{head} node:}
  \begin{itemize}
    \item
      Deleting the first node is no special case
    \item
      We have to consider the first node at other operations
      \begin{itemize}
        \item
          Iterating all nodes
        \item
          Counting of all nodes
        \item
          $\dots$
      \end{itemize}
  \end{itemize}
  \begin{flushleft}
    \input{Lecture/Images/LinkedList/SinglyLinkedListWithHead.tikz}
  \end{flushleft}
\end{frame}

%-------------------------------------------------------------------------------

\begin{frame}[fragile]{Linked Lists}{Implementation - LinkedList - Python}
  \lstinputlisting[
    language=Python,
    tabsize=4,
    style={python-idle-code},
    escapechar={@},
    emph={LinkedList, __init__},
    emphstyle=\color{blue}
  ]{Lecture/Code/LinkedList/LinkedListPart1.py}
\end{frame}

%-------------------------------------------------------------------------------

\begin{frame}[fragile]{Linked Lists}{Implementation - LinkedList - Python}
  \lstinputlisting[
    language=Python,
    tabsize=4,
    style={python-idle-code},
    escapechar={@},
    emphstyle=\color{blue}
  ]{Lecture/Code/LinkedList/LinkedListPart2.py}
\end{frame}

%-------------------------------------------------------------------------------

\begin{frame}[fragile]{Linked Lists}{Implementation - LinkedList - Java}
  \vspace{-1.125em}
  \lstinputlisting[
    language=Java,
    tabsize=4,
    style={java-eclipse-code},
    breaklines=false,
    mathescape=true,
    emph={itemCount, head, last},
    emphstyle=\color{java_static}
  ]{Lecture/Code/LinkedList/LinkedListPart1.java}
\end{frame}

%-------------------------------------------------------------------------------

\begin{frame}[fragile]{Linked Lists}{Implementation - LinkedList - Java}
  \vspace{-0.5em}
  \lstinputlisting[
    language=Java,
    tabsize=4,
    style={java-eclipse-code},
    breaklines=false,
    mathescape=true,
    escapechar={@},
    emph={itemCount, head, last},
    emphstyle=\color{java_static}
  ]{Lecture/Code/LinkedList/LinkedListPart2.java}
\end{frame}

%-------------------------------------------------------------------------------

\begin{frame}[fragile]{Linked Lists}{Implementation - LinkedList - C++ - Header}
  \lstinputlisting[
    language=C++,
    tabsize=4,
    style={cpp-eclipse-code},
    breaklines=false,
    escapechar={@},
    emph={uint64_t},
    emphstyle=\color{cpp_typedef}
  ]{Lecture/Code/LinkedList/LinkedListPart1.h}
\end{frame}

%-------------------------------------------------------------------------------

\begin{frame}[fragile]{Linked Lists}{Implementation - LinkedList - C++ - Header}
  \lstinputlisting[
    language=C++,
    tabsize=4,
    style={cpp-eclipse-code},
    breaklines=false,
    escapechar={@},
    emph={uint64_t},
    emphstyle=\color{cpp_typedef}
  ]{Lecture/Code/LinkedList/LinkedListPart2.h}
\end{frame}

%-------------------------------------------------------------------------------

\begin{frame}[fragile]{Linked Lists}{Implementation - LinkedList - C++}
  \vspace{-1.25em}
  \lstinputlisting[
    language=C++,
    tabsize=4,
    style={cpp-eclipse-code},
    breaklines=false,
    escapechar={@},
    emph={uint64_t},
    emphstyle=\color{cpp_typedef}
  ]{Lecture/Code/LinkedList/LinkedList.cpp}
\end{frame}

%-------------------------------------------------------------------------------

\begin{frame}{Linked Lists}{Implementation}
  \textbf{Head, last:}
  \begin{itemize}
    \item
      \texttt{Head} points to the first node, \texttt{last} to the last node
    \item
      We can append elements to the end of the list in $\mathcal{O}(1)$ through
      the \texttt{last} node
    \item
      We have to keep the pointer to \texttt{last} updated after all operations
  \end{itemize}
  \begin{flushleft}
    \input{Lecture/Images/LinkedList/SinglyLinkedListWithHead.tikz}
  \end{flushleft}
\end{frame}

%-------------------------------------------------------------------------------

\begin{frame}[fragile]{Linked Lists}{Implementation - Append}
  \textbf{Appending an element:}
  \begin{itemize}
    \item
      The pointer to \texttt{last} avoids the iteration of the whole list
      \lstinputlisting[
        language=Python,
        tabsize=4,
        style={python-idle-code},
        breaklines=false,
        escapechar={@},
        emph={append},
        emphstyle=\color{blue}
      ]{Lecture/Code/LinkedList/LinkedListAppend.py}
  \end{itemize}
  \vspace{-2.0em}
  \begin{flushleft}
    \input{Lecture/Images/LinkedList/SinglyLinkedListWithHeadAppend.tikz}
  \end{flushleft}
\end{frame}

%-------------------------------------------------------------------------------

\begin{frame}[fragile]{Linked Lists}{Implementation - Insert After}
  \textbf{Inserting after node \texttt{cur}:}
  \begin{itemize}
    \item
      The pointer to \texttt{head} is not modified
    \item
      \lstinputlisting[
        language=Python,
        tabsize=4,
        style={python-idle-code},
        breaklines=false,
        escapechar={@},
        emph={insertAfter},
        emphstyle=\color{blue}
      ]{Lecture/Code/LinkedList/LinkedListInsertAfter.py}
  \end{itemize}
\end{frame}

%-------------------------------------------------------------------------------

\begin{frame}{Linked Lists}{Implementation - Insert After}
  \textbf{Inserting after node \texttt{cur}:}
  \begin{flushleft}
    \input{Lecture/Images/LinkedList/SinglyLinkedListWithHeadInsertAfter.tikz}
  \end{flushleft}
\end{frame}

%-------------------------------------------------------------------------------

\begin{frame}[fragile]{Linked Lists}{Implementation - Remove}
  \textbf{Remove node \texttt{cur}:}
  \begin{itemize}
    \item
      Searching the predecessor in $\mathcal{O}(n)$
      \lstinputlisting[
        language=Python,
        tabsize=4,
        style={python-idle-code},
        breaklines=false,
        escapechar={@},
        emph={remove},
        emphstyle=\color{blue},
        morekeywords={None}
      ]{Lecture/Code/LinkedList/LinkedListRemove.py}
  \end{itemize}
\end{frame}

%-------------------------------------------------------------------------------

\begin{frame}{Linked Lists}{Implementation - Remove}
  \textbf{Remove node \texttt{cur}:}
  \begin{flushleft}
    \input{Lecture/Images/LinkedList/SinglyLinkedListWithHeadRemove.tikz}
  \end{flushleft}
\end{frame}

%-------------------------------------------------------------------------------

\begin{frame}[fragile]{Linked Lists}{Implementation - Get}
  \textbf{Getting a reference to node at \texttt{pos}:}
  \begin{itemize}
    \item
      Iterate the entries of the list until at position ($\mathcal{O}(n)$)
      \lstinputlisting[
        language=Python,
        tabsize=4,
        style={python-idle-code},
        breaklines=false,
        escapechar={@},
        emph={get},
        emphstyle=\color{blue},
        morekeywords={None}
      ]{Lecture/Code/LinkedList/LinkedListGet.py}
  \end{itemize}
\end{frame}

%-------------------------------------------------------------------------------

\begin{frame}[fragile]{Linked Lists}{Implementation - Contains}
  \textbf{Searching a \texttt{value}:}
  \begin{itemize}
    \item
      First element is head without an assigned value
    \item
      Iterate the entries of the list until value found ($\mathcal{O}(n)$)
      \lstinputlisting[
        language=Python,
        tabsize=4,
        style={python-idle-code},
        breaklines=false,
        escapechar={@},
        emph={contains},
        emphstyle=\color{blue},
        morekeywords={None}
      ]{Lecture/Code/LinkedList/LinkedListContains.py}
  \end{itemize}
\end{frame}

%-------------------------------------------------------------------------------

\begin{frame}{Linked Lists}{Runtime}
  \textbf{Runtime:}
  \begin{itemize}
    \item
      Singly linked list:
      \begin{tabbing}
        {\color{Mittel-Blau}\texttt{previous}} \=\kill
        {\color{Mittel-Blau}\texttt{next}} \>
        in $\mathcal{O}(1)$\\
        {\color{Mittel-Blau}\texttt{previous}} \>
        up to $\Theta(n)$\\
        {\color{Mittel-Blau}\texttt{insert}} \>
        in $\mathcal{O}(1)$\\
        {\color{Mittel-Blau}\texttt{remove}} \>
        up to $\Theta(n)$\\
        {\color{Mittel-Blau}\texttt{lookup}} \>
        up to $\Theta(n)$
      \end{tabbing}
    \item
      Better with {\color{Mittel-Blau}doubly linked lists}
  \end{itemize}
\end{frame}

%-------------------------------------------------------------------------------

\begin{frame}{Linked Lists}{Doubly Linked List}
  \textbf{Doubly linked list:}
  \begin{itemize}
    \item
      Each node has a reference to its successor and its
      {\color{Mittel-Blau}predecessor}
    \item
      We can iterate the list forward and backward
  \end{itemize}
  \begin{flushleft}
    \input{Lecture/Images/LinkedList/DoublyLinkedList.tikz}
  \end{flushleft}
\end{frame}

%-------------------------------------------------------------------------------

\begin{frame}{Linked Lists}{Doubly Linked List}
  \textbf{Doubly linked list:}
  \begin{itemize}
    \item
      It is helpful to have a {\color{Mittel-Blau}head} node
    \item
      We only need {\color{Mittel-Blau}one head} node if we connect the list
      cyclic
  \end{itemize}
  \begin{flushleft}
    \input{Lecture/Images/LinkedList/DoublyLinkedListWithHeadCyclicIntroduction.tikz}
  \end{flushleft}
\end{frame}

%-------------------------------------------------------------------------------

\begin{frame}{Linked Lists}{Runtime}
  \textbf{Runtime:}
  \begin{itemize}
    \item
      Doubly linked list:
      \begin{tabbing}
        {\color{Mittel-Blau}\texttt{next}} /
        {\color{Mittel-Blau}\texttt{previous}} \=\kill
        {\color{Mittel-Blau}\texttt{next}} /
        {\color{Mittel-Blau}\texttt{previous}}\>
        in $\mathcal{O}(1)$\\
        \hspace{1.5em}Each element has a pointer to its predecessor /\\
        \hspace{1.5em}successor\\[0.5em]
        {\color{Mittel-Blau}\texttt{insert}} /
        {\color{Mittel-Blau}\texttt{remove}} \>
        in $\mathcal{O}(1)$\\
        \hspace{1.5em}We have to adjust a constant amount of pointers\\[0.5em]
        {\color{Mittel-Blau}\texttt{lookup}} \>
        up to $\Theta(n)$
      \end{tabbing}
    \item
      Even if the elements are sorted we can only retrieve them in $\Theta(n)$.
      Why?
  \end{itemize}
\end{frame}

%-------------------------------------------------------------------------------

\begin{frame}{Linked Lists}{List in real program}
  \textbf{Linked list in book:}
  \vspace{-1.5em}
  \begin{flushleft}
    \input{Lecture/Images/LinkedList/DoublyLinkedListWithHeadCyclic.tikz}
  \end{flushleft}
\end{frame}

%-------------------------------------------------------------------------------

\begin{frame}{Linked Lists}{List in real program}
  \textbf{Linked list in memory:}
  \vspace{-1.5em}
  \begin{flushleft}
    \input{Lecture/Images/LinkedList/DoublyLinkedListWithHeadCyclicMemory.tikz}
  \end{flushleft}
\end{frame}