% Reset to Heapsort
\setcounter{subsubsection}{0}

\begin{frame}<beamer>{Structure}
  \tableofcontents[currentsection,currentsubsection]
\end{frame}

%-------------------------------------------------------------------------------

\begin{frame}{Runtime - Heapsort}
  \textbf{Heapsort has the following steps:}
  \begin{itemize}
    \item
      \textbf{Initially:} \texttt{heapify} list of $n$ elements
    \item<2- |handout:1>
    \textbf{Then:} until all $n$ elements are sorted
    \begin{itemize}
      \item<3- |handout:1>
        Remove root as minimal element
      \item<4- |handout:1>
        Move last leaf to root position
      \item<5- |handout:1>
        Repair heap by \texttt{sifting}
    \end{itemize}
  \end{itemize}
\end{frame}

%-------------------------------------------------------------------------------

\begin{frame}{Runtime - Heapsort}{Heapify}
  Runtime of \texttt{heapify} depends on depth {\color{MainA}$d$}:
  \begin{figure}[!h]
    \begin{adjustbox}{width=0.7\linewidth}
      \input{Images/HeapSort/BinaryTree_Layer.tikz}
    \end{adjustbox}
    \vspace{-0.5em}
  \end{figure}
  \onslide<2- |handout:1>{
    Runtime of \texttt{heapify} with depth of {\color{MainA}$d$}:}
  \begin{itemize}
    \item<2- |handout:1>
      No costs at depth {\color{MainA}$d$} with {\color{MainA}$2^{d-1}$}
      (or less) nodes
    \item<3- |handout:1>
      The cost for \texttt{sifting} with depth {\color{MainA}$1$}
      is at most {\color{MainA}$1 C$} per node
    \item<4- |handout:1>
      In general: \texttt{Sifting} costs are linear with path length
      \textbf{and} number of nodes
  \end{itemize}
\end{frame}

%-------------------------------------------------------------------------------

\begin{frame}{Runtime - Heapsort}
  \texttt{Heapify} total runtime:
  \vspace{-1em}
  \begin{figure}[!h]
    \begin{adjustbox}{width=0.7\linewidth}
      \input{Images/HeapSort/BinaryTree_Layer_General.tikz}
    \end{adjustbox}
    \vspace{-0.5em}
  \end{figure}
  \vspace{-1.5em}
  \begin{table}[!h]
    \begin{center}%
      \begin{tabular}{c|c|c|c|c}
        Depth & Nodes & Path length & Costs per node
        & \onslide<6- |handout:1>{\color{MainB}Upper bound}\\
        \hline
        $d$ & $2^{d-1}$ & 0 & $\leq C \cdot 0$ &
        \onslide<6- |handout:1>{\color{MainB}$\leq C \cdot 1$}\\
        \onslide<2- |handout:1>{$d-1$ & $2^{d-2}$ & 1 & $\leq C \cdot 1$ &}
        \onslide<6- |handout:1>{\color{MainB}$\leq C \cdot 2$}\\
        \onslide<3- |handout:1>{$d-2$ & $2^{d-3}$ & 2 & $\leq C \cdot 2$ &}
        \onslide<6- |handout:1>{\color{MainB}$\leq C \cdot 3$}\\
        \onslide<4- |handout:1>{$d-3$ & $2^{d-4}$ & 3 & $\leq C \cdot 3$ &}
        \onslide<6- |handout:1>{\color{MainB}$\leq C \cdot 4$}\\
      \end{tabular}%
      \label{tab:sifting_costs}%
    \end{center}%
  \end{table}
  \vspace{-1em}
  \onslide<5- |handout:1>{
    \textbf{In total:}\hspace{1.5em}
    \begin{math}
      \displaystyle
      T(d) \leq \sum\limits_{i=1}^{d} \left(C \cdot (i - 1) \cdot 2^{d-i}\right)
      \onslide<6- |handout:1>{\textcolor{MainB}{
        \leq \sum\limits_{i=1}^{d} \left(C \cdot i \cdot 2^{d-i}\right)
      }}
    \end{math}
  }
\end{frame}

%-------------------------------------------------------------------------------

\begin{frame}{Runtime - Heapsort}
  \begin{itemize}
    \item
      Runtime for heapify:
      \[\displaystyle
      T(d) \leq C \cdot \sum \limits^d_{i=2} \left(i \cdot 2^{d-i} \right)
      \leq C \cdot 2^{d + 1}\]
    \item
      Runtime for the other operations:
      \begin{itemize}
        \item
          Constant costs for taking out $n \, \times$ maximum.
        \item
          Maximum of $d$ steps repairing the heap $n$ times.
        \item
          Depth of heap at the start is $d \leq 1 + \log_2 n$
        \item
          Remove costs:
          \begin{itemize}
            \item
              Constant size:
              $T(n) \leq n \cdot (1 +\log_2 n) \cdot C$
            \item
              But the number of elements is decreasing:\\
              $T(n) \leq 2 \cdot n  \, \log_2 n \cdot C$ (for $n > 2$).
          \end{itemize}
      \end{itemize}
  \end{itemize}
\end{frame}

%-------------------------------------------------------------------------------

\begin{frame}{Runtime - Heapsort}
  \textbf{Runtime costs:}
  \begin{itemize}
    \item
      Heapify: $T(n) \leq 4 \cdot n \cdot C$
    \item
      Remove: $T(n) \leq 2 \cdot n \, \log_2 n \cdot C$
    \item
      Total runtime: $T(n) \leq 6 \cdot n \, \log_2 n \cdot C$
    \item
      Constraints:
      \begin{itemize}
        \item
          Upper bound:
          $C_2 \cdot n \, \log_2 n \geq T(n)$ (for $n \geq 2$)
        \item
          Lower bound:
          $C_1 \cdot n \, \log_2 n \leq T(n)$ (for $n \geq 2$)
        \item
          $\Rightarrow$ $C_1$ and $C_2$ are constant
      \end{itemize}
  \end{itemize}
\end{frame}