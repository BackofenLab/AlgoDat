% Reset to Heapsort
\setcounter{subsubsection}{0}

\begin{frame}<beamer>{Structure}
  \tableofcontents[currentsection,currentsubsection]
\end{frame}

%-------------------------------------------------------------------------------

\begin{frame}{Runtime - Heapsort}
  \textbf{Heapsort has the following steps:}
  \begin{itemize}
    \item
      \textbf{Initially:} \texttt{heapify} list of $n$ elements
    \item<2- |handout:1>
    \textbf{Then:} until all $n$ elements are sorted
    \begin{itemize}
      \item<3- |handout:1>
        Remove root as minimal element
      \item<4- |handout:1>
        Move last leaf to root position
      \item<5- |handout:1>
        Repair heap by \texttt{sifting}
    \end{itemize}
  \end{itemize}
\end{frame}

%-------------------------------------------------------------------------------

\begin{frame}{Runtime - Heapsort}{Heapify}
  Runtime of \texttt{heapify} depends on depth {\color{MainA}$d$}:
  \begin{figure}[!h]
    \begin{adjustbox}{width=0.7\linewidth}
      \input{Images/HeapSort/BinaryTree_Layer.tikz}
    \end{adjustbox}
    \vspace{-0.5em}
  \end{figure}
  \onslide<2- |handout:1>{
    Runtime of \texttt{heapify} with depth of {\color{MainA}$d$}:}
  \begin{itemize}
    \item<2- |handout:1>
      No costs at depth {\color{MainA}$d$} with {\color{MainA}$2^{d-1}$}
      (or less) nodes
    \item<3- |handout:1>
      The cost for \texttt{sifting} with depth {\color{MainA}$1$}
      are at most {\color{MainA}$1 C$} per node
    \item<4- |handout:1>
      In general: \texttt{Sifting} costs are linear with path length
      \textit{and} number of nodes
  \end{itemize}
\end{frame}

%-------------------------------------------------------------------------------

\begin{frame}{Runtime - Heapsort}
  Runtime of \textit{heapify} with depth of $d$:
  \begin{itemize}
    \item
      No costs at depth $d$ with $2^{d - 1}$ (or less) nodes.
    \item
      In a full heap with depth $d$ are $2 \, d - 1$ non-root nodes.\\
      The cost for \textbf{sifting} with depth $1$ are $1 \, C$
      ({\color{Mittel-Blau}compare})\\
      or $2 \, C$ ({\color{Mittel-Blau}compare} and {\color{Mittel-Blau}swap})
  \end{itemize}%
  \begin{figure}[!h]%
    \begin{table}%
      \begin{center}%
        \begin{tabular}{c|c|c|c}
          Depth:     & Nodes:    & Path length: & Costs per node:\\
          \hline
          $d - 1$    & $2^d$     & 1            & $\leq 2 \cdot C$\\
          $d - 2$    & $2^{d-1}$ & 2            & $\leq 4 \cdot C$\\
          $\vdots$   & $\vdots$  & $\vdots$     & $\vdots$ 
        \end{tabular}%
        \caption{Sifting costs}%
        \label{tab:sifting_costs}%
      \end{center}%
    \end{table}%
  \end{figure}
\end{frame}

%-------------------------------------------------------------------------------

\begin{frame}{Runtime - Heapsort}
  \begin{itemize}
    \item
      Runtime for heapify:
      \[\displaystyle
      T(d) \leq C \cdot \sum \limits^d_{i=2} \left(i \cdot 2^{d-i} \right)
      \leq C \cdot 2^{d + 1}\]
    \item
      Runtime for the other operations:
      \begin{itemize}
        \item
          Constant costs for taking out $n \, \times$ maximum.
        \item
          Maximum of $d$ steps repairing the heap $n$ times.
        \item
          Depth of heap at the start is $d \leq 1 + \log_2 n$
        \item
          Remove costs:
          \begin{itemize}
            \item
              Constant size:
              $T(n) \leq n \cdot (1 +\log_2 n) \cdot C$
            \item
              But the number of elements is decreasing:\\
              $T(n) \leq 2 \cdot n  \, \log_2 n \cdot C$ (for $n > 2$).
          \end{itemize}
      \end{itemize}
  \end{itemize}
\end{frame}

%-------------------------------------------------------------------------------

\begin{frame}{Runtime - Heapsort}
  \textbf{Runtime costs:}
  \begin{itemize}
    \item
      Heapify: $T(n) \leq 4 \cdot n \cdot C$
    \item
      Remove: $T(n) \leq 2 \cdot n \, \log_2 n \cdot C$
    \item
      Total runtime: $T(n) \leq 6 \cdot n \, \log_2 n \cdot C$
    \item
      Constraints:
      \begin{itemize}
        \item
          Upper bound:
          $C_2 \cdot n \, \log_2 n \geq T(n)$ (for $n \geq 2$)
        \item
          Lower bound:
          $C_1 \cdot n \, \log_2 n \leq T(n)$ (for $n \geq 2$)
        \item
          $\Rightarrow$ $C_1$ and $C_2$ are constant
      \end{itemize}
  \end{itemize}
\end{frame}