\section{Divide and Conquer}
\toclesssubsection{Introduction}
\label{chap:divide_and_conquer}

%-------------------------------------------------------------------------------

\begin{frame}{Divide and Conquer}{Introduction}
  \textbf{Concept:}
  \begin{itemize}
    \item<2->
      {\color{MainA}Divide} the problem into smaller subproblems
    \item<3->
      {\color{MainA}Conquer} the subproblems through recursive solving.\\
      If subproblems are small enough solve them directly
    \item<4->
      {\color{MainA}Connect} all solutions of the subproblems to the solution of the
      full problem
    \item<5->
      {\color{MainA}Recursive} application of the algorithm to ever smaller
      subproblems
    \item<6->
      {\color{MainA}Direct} solving of sufficiently small subproblems
  \end{itemize}
\end{frame}

%-------------------------------------------------------------------------------

\codeslide{python}{
  \begin{frame}{Divide and Conquer}{Introduction - Python}
    \begin{itemize}
      \item<2->Function {\color{MainA}solve} for solving a {\color{MainA}problem} of size {\color{MainA}$n$}
    \end{itemize}
  \onslide<3->
  \vspace{-0.5em}
  \lstinputlisting[
    language=Python,
    basicstyle=\small,
    tabsize=4,
    style={python-idle-code},
    escapechar={@},
    emph={solve},
    emphstyle=\color{blue}
  ]{Code/DivideAndConquer/DivideAndConquer_Concept.py}
\end{frame}
}

%TODO: Implement for Java / C++

%-------------------------------------------------------------------------------

\begin{frame}{Divide and Conquer}{Features}
  \textbf{Divide and Conquer:}
  \begin{itemize}
    \item<2-| handout: 1>
      Can help with conceptual hard problems
    \item<3-| handout: 1>
      {\color{MainA}Solution} of the trivial problems has to be known
    \item<4-| handout: 1>
      {\color{MainA}Dividing} into subproblems has to be possible
    \item<5-| handout: 1>
      {\color{MainA}Combination} of solutions has to be possible
  \end{itemize}
\end{frame}

%-------------------------------------------------------------------------------

\begin{frame}{Divide and Conquer}{Features}
  \textbf{Features:}
  \begin{itemize}
    \item<1->
      Realization of {\color{MainA}efficient solutions}
      \begin{itemize}
        \item<2->
          If trivial solution is {\color{MainA}$\in O(1)$}
        \item<3->
          And separation / combination of subproblems is
          {\color{MainA}$\in O(n)$}
        \item<4->
          And the number of subproblems is limited
        \item<5->
          The runtime is {\color{MainA}$\in O(n \cdot \log n)$}
      \end{itemize}
    \item<6->
      Suitable for parallel processing
      \begin{itemize}
        \item<7->
          Parallel processing of subproblems possible since subproblems are {\color{MainA}independent} of each other
      \end{itemize}
  \end{itemize}
\end{frame}

%-------------------------------------------------------------------------------

\begin{frame}{Divide and Conquer}{Implementation}
  \textbf{Definition of the trivial case:}
  \begin{itemize}
    \item<2->
      Smaller subproblems are elegant and simple
    \item<3->
      On the other hand the efficiency will be improved if relatively big subproblems
      can be solved directly
    \item<4->
      Recursion depth should not get too big (stack / memory overhead)
  \end{itemize}
\end{frame}

%-------------------------------------------------------------------------------

\begin{frame}{Divide and Conquer}{Implementation}
  \textbf{Division in subproblems:}
  \begin{itemize}
    \item<2->
      Choosing the number of subproblems and the concrete allocation can be
      demanding
  \end{itemize}
  \onslide<3->
  \vspace{1em}
  \textbf{Combination of solutions:}
  \begin{itemize}
    \item<4->
      Typically conceptionally demanding
  \end{itemize}
\end{frame}

%-------------------------------------------------------------------------------

\begin{frame}{Divide and Conquer}{Example - Maximum Subtotal}
  \textbf{Example - Maximum Subtotal}
   \onslide<2->
   \textbf{Input:}
    \onslide<3->
  \begin{itemize}
    \item<4->
      Sequence {\color{MainA}$X$} of {\color{MainA}$n$} integers
  \end{itemize}
   \onslide<5->
  \textbf{Output:}
  \begin{itemize}
    \item<6->
      Maximum sum of related subsequence and its index boundary
  \end{itemize}
   \onslide<7->
    \vspace{1em}
    \begin{table}[!t]
      \begin{tabular}{c|c|c|c|c|c|c|c|c|c|c}
        Index & 0 & 1 & 2 & 3 & 4 & 5 & 6 & 7 & 8 & 9\\
        \midrule
        Value & 31 & -41 & 59 & 26 & -53 & 58 & 97 & -93 & -23 & 84
      \end{tabular}
      \end{table}
    \onslide<8-> 
  \textbf{Output:} sum: 187, start: 2, end: 6
\end{frame}

%-------------------------------------------------------------------------------

%% \begin{frame}{Divide and Conquer}{Example - Maximum Subtotal}
%%   \begin{example}[Maximum Subtotal]
%%     \vspace{-1em}
%%     \begin{table}[!t]
%%       \caption{Input values}
%%       \begin{tabular}{c|c|c|c|c|c|c|c|c|c|c}
%%         Index & 0 & 1 & 2 & 3 & 4 & 5 & 6 & 7 & 8 & 9\\
%%         \midrule
%%         Value & 31 & -41 & 59 & 26 & -53 & 58 & 97 & -93 & -23 & 84
%%       \end{tabular}
%%       \label{tab:divide_and_conquer:max_subtotal_example_values}
%%     \end{table}
%%     \vspace{6em}
%%     %TODO: Hand-Drawings here (Free space) or no free space?
    
%%     \textbf{Output:} Sum: 187, Start: 2, End: 6
%%   \end{example}
%% \end{frame}

%-------------------------------------------------------------------------------

\begin{frame}{Divide and Conquer}{Example - Maximum Subtotal}
  \textbf{Application:}
  \begin{itemize}
    \item
      Maximum profit of buying and selling shares
  \end{itemize}
  \begin{figure}
    \begin{center}
      \includegraphics[width=0.9\textwidth]%
        {Images/DivideAndConquer/shares-graph.pdf}
    \end{center}
    \caption{stock value over time}
    \label{fig:divide_and_conquer:shares_value}
  \end{figure}
\end{frame}

%-------------------------------------------------------------------------------

\codeslide{python}{
  \begin{frame}{Divide and Conquer}{Example - Maximum Subtotal - Python}
    \textbf{Naive solution (brute force)}
    \onslide<2->
      \vspace{-0.5em}
      \lstinputlisting[
        language=Python,
        basicstyle=\small,
        tabsize=4,
        style={python-idle-code},
        escapechar={@},
        emph={maxSubArray},
        emphstyle=\color{blue}
      ]{Code/DivideAndConquer/MaxSubTotal_Naive.py}
    \end{frame}

    %-------------------------------------------------------------------------------

    \begin{frame}{Divide and Conquer}{Example - Maximum Subtotal - Python}
      \textbf{Runtime - Upper bound}
      \onslide<2->
      \vspace{-0.5em}
      \lstinputlisting[
        language=Python,
        basicstyle=\small,
        tabsize=4,
        style={python-idle-code},
        escapechar={@},
        emph={maxSubArray},
        emphstyle=\color{blue}
      ]{Code/DivideAndConquer/MaxSubTotal_Naive_Runtime.py}
    \end{frame}
}

%TODO: Implement for Java / C++

%-------------------------------------------------------------------------------

\begin{frame}{Divide and Conquer}{Example - Maximum Subtotal}
  \textbf{Upper bound:}
  \begin{itemize}
    \item<2->
      Three nested loops
    \item<3->
      Each loop with runtime {\color{MainA}$O(n)$}
    \item<4->
      Algorithm runtime of {\color{MainA}$O(n^3)$}
  \end{itemize}
\end{frame}

%-------------------------------------------------------------------------------

\begin{frame}{Divide and Conquer}{Example - Maximum Subtotal - Runtime}
  \textbf{Lower bound:}
  \begin{table}
    \caption{Operations}
    \label{fig:divide_and_conquer:max_sub_total_operations}
    \begin{tabular}{c|c|c}
      $i$ & Additions & $j$\\
      \midrule
      $\frac{n}{3} \in O(n)$ &
      $\frac{n}{3} \in O(n)$ &
      $\frac{n}{3} \in O(n)$\\
    \end{tabular}
  \end{table}
  \begin{itemize}
    \item<2->
      We iterate at least {\color{MainA}$\frac{n}{3}$} values for {\color{MainA}$i$}
    \item<3->
      For each {\color{MainA}$i$} we iterate at least {\color{MainA}$\frac{n}{3}$} values for {\color{MainA}$j$}
    \item<4->
      For each {\color{MainA}$j$} we have at least {\color{MainA}$\frac{n}{3}$} additions
    \item<5->
      We need at least {\color{MainA}$T(n) = (\frac{n}{3})^3 \in \Omega(n^3)$} steps
  \end{itemize}
  
\end{frame}

%-------------------------------------------------------------------------------

\begin{frame}{Divide and Conquer}{Example - Maximum Subtotal - Runtime}
  \textbf{Runtime:}
  \begin{itemize}
    \item<2->
      With {\color{MainA}$T(n) \in O(n^3)$} and
      {\color{MainA}$T(n) \in \Omega(n^3)$} we know:
      \begin{displaymath}
        \color{MainA}
        T(n) \in \Theta(n^3)
      \end{displaymath}
    \item<3->
      It is hard to solve the problem in a worse way $\ldots$
  \end{itemize}
\end{frame}

%-------------------------------------------------------------------------------

\begin{frame}{Divide and Conquer}{Example - Maximum Subtotal - Runtime}
  \textbf{Current approach:}
  \begin{itemize}
    \item<2->
      Calculating the sum for range from $i$ to $j$ with loop
      \begin{displaymath}
        S_{i,\,j} = X[i] + X[i+1] + \dots + X[j]
      \end{displaymath}
  \end{itemize}
  \onslide<3->
   \textbf{Better approach:}
   \begin{itemize}
    \item<4->
      Incremental sum instead of loop
      \begin{eqnarray*}
        S_{i,\,j+1} &=& X[i] + X[i+1] + \dots + X[j] + X[j+1]\\
        S_{i,\,j+1} &=& S_{i,\,j} + X[j+1]
        ~{\color{MainA}\in O(1)}\hspace{1em}
          \text{instead of}\hspace{1em} {\color{MainA}\in O(n)}
      \end{eqnarray*}
  \end{itemize}
\end{frame}

%-------------------------------------------------------------------------------

\codeslide{python}{
  \begin{frame}{Divide and Conquer}{Example - Maximum Subtotal - Python}
     \textbf{Better solution:}
     \onslide<2->
  \vspace{-0.5em}
  \lstinputlisting[
    language=Python,
    basicstyle=\small,
    tabsize=4,
    style={python-idle-code},
    escapechar={@},
    emph={maxSubArray},
    emphstyle=\color{blue}
  ]{Code/DivideAndConquer/MaxSubTotal.py}
   \begin{itemize}
   \item<3->Runtime {\color{MainA}$\in O(n^2)$}
   \end{itemize}  
\end{frame}
}

%TODO: Implement for Java / C++

%-------------------------------------------------------------------------------

\begin{frame}{Divide and Conquer}{Example - Maximum Subtotal}
  \textbf{Divide and Conquer:}
  \vspace{-1.5em}
  \begin{figure}
    \begin{adjustbox}{width=\linewidth}
      \input{Images/DivideAndConquer/MaxSubTotal_Divide.tikz}
    \end{adjustbox}
    \label{fig:divide_and_conquer:max_sub_total_divide}
  \end{figure}
   \vspace{-1.5em}
\textbf{Divide and Conquer idea to solve:}
  \begin{itemize}
  \item<1->
    Split the sequence in the middle
  \item<2->
    Solve left half of the problem
  \item<3->
    Solve right half and combine both solutions into one
  \item<4->
    Maximum might be located in {\color{MainA}left~half~($A$)}
    or {\color{MainA}right~half~($B$)}
  \item<5->
    Problem: Maximum can {\color{MainA} overlap the split}
  \item<6->
    To solve this case we have to calculate {\color{MainA}rmax}
    and {\color{MainA}lmax}
  \item<7->
    The overall solution is the {\color{MainA}maximum of $A$, $B$ and $C$}
  \end{itemize}
\end{frame}

%-------------------------------------------------------------------------------

\begin{frame}{Divide and Conquer}{Example - Maximum Subtotal}
  \textbf{Principle - Divide and Conquer:}
  \begin{itemize}
    \item<2->
      Small problems are solved directly:
      {\color{MainA}$n = 1 \Rightarrow \max = X[0]$}
    \item<3->
      Bigger problems are partitioned into two subproblems
      and solved recursively.
      Subsolutions {\color{MainA}A} and {\color{MainA}B} are returned
    \item<4->
      To determine subsolution {\color{MainA}C}, {\color{MainA}rmax}
      and {\color{MainA}lmax} for the subproblems are computed
    \item<5->
      The overall solution is the {\color{MainA}maximum of $A$, $B$ and $C$}
  \end{itemize}
\end{frame}

%-------------------------------------------------------------------------------

\codeslide{python}{
  \begin{frame}{Divide and Conquer}{Example - Maximum Subtotal - Python}
  \lstinputlisting[
    language=Python,
    basicstyle=\small,
    tabsize=4,
    style={python-idle-code},
    escapechar={@},
    emph={maxSubArray},
    emphstyle=\color{blue},
    breaklines=false
  ]{Code/DivideAndConquer/MaxSubTotal_DivideAndConquer.py}
\end{frame}
}

%TODO: Implement for Java / C++
